# UI 界面设计需求文档

## 1. 概述

本文档描述了 Aries Game System 的用户界面设计需求。UI 采用深色主题,基于 HTML5 Canvas 游戏引擎和 WebSocket 实时通信,支持多玩家在线游戏体验。

## 2. 整体布局

### 2.1 页面结构

```
┌────────────────────────────────────────────────────────────────┐
│                    游戏画布 (Canvas)                        │
│                                                              │
│  ┌──────────┐                                     ┌──────┐ │
│  │          │                                     │玩家   │ │
│  │ 左侧面板 │            游戏画面                 │列表   │ │
│  │          │                                     │       │ │
│  │          │                                     └──────┘ │
│  │          │                                     ┌──────┐ │
│  │          │                                     │聊天   │ │
│  │          │                                     │记录   │ │
│  │          │                                     │       │ │
│  └──────────┘                                     └──────┘ │
└────────────────────────────────────────────────────────────────┘
```

### 2.2 布局规范

- **游戏画布**: 全屏显示,占据整个浏览器窗口
- **左侧面板**: 固定位置 `top: 10px, left: 10px`, z-index: 100
- **右侧面板**: 固定位置 `right: 10px, bottom: 10px`, z-index: 100
- **面板样式**: 半透明黑色背景 `rgba(0, 0, 0, 0.8)`, 圆角 5px, 1px 边框

## 3. 左侧面板设计

### 3.1 玩家身份面板

**位置**: 左上角第一个面板

**内容**:
```
玩家身份
━━━━━━━━━
DID: 未创建 / [DID字符串...]
状态: 未连接 / 已连接
[创建身份] [连接游戏]
```

**功能**:
- 显示当前玩家的 DID (前30字符 + ...)
- 显示连接状态
- "创建身份" 按钮: 仅在未创建 DID 时显示
- "连接游戏" 按钮: 在已创建 DID 且未连接时启用

**状态指示**:
- 未创建: 红色显示
- 已创建: 绿色显示
- 未连接: 红色显示
- 已连接: 绿色显示

### 3.2 钱包面板

**位置**: 左侧第二个面板

**内容**:
```
钱包
━━━━━━━━━
凭证数量: 0
[查看钱包]
```

**功能**:
- 显示已获得的可验证凭证数量
- "查看钱包" 按钮: 打开钱包模态框

**钱包模态框**:
- 居中显示,背景半透明
- 显示所有凭证详细信息
- 支持凭证验证和删除操作

### 3.3 游戏控制面板

**位置**: 左侧第三个面板

**内容**:
```
游戏控制
━━━━━━━━━
位置: (x, y)
使用 WASD 键移动
[剧本编辑器]
```

**功能**:
- 实时显示玩家坐标位置
- 显示操作提示
- "剧本编辑器" 按钮: 在新标签页打开剧本编辑器

## 4. 右侧面板设计

### 4.1 在线玩家列表面板

**位置**: 右上角面板

**尺寸**:
- 宽度: 280px
- 最大高度: 280px
- 列表高度: 200px (可滚动)

**内容**:
```
在线玩家 (3)
━━━━━━━━━━━━
● Player1 Lv.5
● Player2 Lv.3
● You Lv.1
```

**功能**:
- 显示在线玩家数量
- 列出所有在线玩家
- 显示玩家昵称和等级
- 标识当前玩家 (显示"(你)"标签)
- 实时更新 (每秒刷新一次)

**样式规范**:
- `.player-item`: 玩家条目,底部边框分隔
- `.player-status.online`: 在线状态绿色圆点
- `.player-status.offline`: 离线状态红色圆点
- `.player-item.current-player`: 当前玩家高亮,蓝色背景
- `.current-player-badge`: "(你)"标签,蓝色加粗
- 悬停效果: 背景色变为 `rgba(255,255,255,0.1)`

**滚动条**:
- 宽度: 6px
- 轨道: 半透明黑色
- 滑块: 灰色 `#555`,圆角 3px

### 4.2 聊天记录面板

**位置**: 右下角面板 (玩家列表面板下方)

**尺寸**:
- 宽度: 280px (与玩家列表面板保持一致)
- 聊天消息高度: 300px (可滚动)

**内容**:
```
聊天记录
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[消息列表...]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[输入消息...]
```

**功能**:
- 显示所有聊天和系统消息
- 支持输入消息并按 Enter 发送
- 自动滚动到最新消息
- 限制消息数量 (最多保留 100 条)
- 支持多种消息类型

**消息类型与样式**:

1. **系统消息** (`system`)
   - 颜色: 黄色 `#ffcc00`
   - 样式: 斜体
   - 示例: "Player1 加入了游戏", "Player2 断开连接"

2. **普通聊天** (`chat`)
   - 昵称颜色: 蓝色 `#2196F3`,加粗
   - 消息颜色: 白色 `#ffffff`
   - 格式: `[时间] 昵称: 消息内容`
   - 示例: `22:08:15 Player1: 大家好!`

3. **成功消息** (`success`)
   - 颜色: 绿色 `#4CAF50`
   - 示例: "Player1 完成了任务: 新手任务"

4. **错误消息** (`error`)
   - 颜色: 红色 `#ff4444`
   - 示例: "错误: 连接已断开"

5. **凭证消息** (`credential`)
   - 颜色: 紫色 `#9C27B0`,加粗
   - 示例: "获得新凭证!"

**时间戳格式**:
- 格式: `HH:mm:ss` (24小时制)
- 颜色: 灰色 `#888`
- 字体大小: 11px
- 位于消息右侧

**输入框**:
- 宽度: 100%
- 背景: `#222`
- 文字颜色: 白色
- 占位符: "输入消息..."
- 边框: 1px `#555`
- 圆角: 3px
- 内边距: 5px
- 上边距: 5px

**滚动条**:
- 宽度: 8px
- 轨道: 半透明黑色
- 滑块: 灰色 `#555`,圆角 4px
- 悬停效果: 变为 `#777`

## 5. 通知系统

### 5.1 通知样式

**位置**: 右上角固定 (临时显示)

**尺寸**:
- 内边距: 10px 20px
- 圆角: 5px
- z-index: 10000

**动画**:
- 进入: 从右侧滑入 `slideIn` 0.3s
- 离开: 向右侧滑出 `slideOut` 0.3s
- 显示时长: 3秒后自动消失

**类型与颜色**:
- 成功 (`success`): 绿色 `#4CAF50`
- 错误 (`error`): 红色 `#f44336`
- 警告 (`warning`): 橙色 `#ff9800`
- 信息 (`info`): 蓝色 `#2196F3`

**交互**:
- 点击通知可手动关闭

### 5.2 凭证获得通知

**位置**: 屏幕中央固定 (临时显示)

**样式**:
- 背景: 紫色渐变 `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
- 边框: 2px 金色边框
- 圆角: 15px
- 内边距: 30px
- 文本居中

**动画**:
- 进入: `credentialPop` 0.5s (缩放效果)
- 显示时长: 5秒后自动消失

**内容**:
```
🏆
获得新凭证!
AchievementCredential
[确定]
```

## 6. 模态对话框

### 6.1 任务对话框

**位置**: 屏幕中央

**尺寸**:
- 最小宽度: 300px
- 背景: `#222`
- 边框: 2px `#555`
- 圆角: 10px
- 内边距: 20px

**内容**:
```
[任务名称]
━━━━━━━━━
[任务描述]

目标:
☑ 目标1 (1/1)
☐ 目标2 (0/3)

奖励:
• 凭证: WelcomeCredential
• 经验: 100

[关闭] [接受任务]
```

### 6.2 钱包模态框

**位置**: 屏幕中央

**尺寸**:
- 最小宽度: 400px
- 背景: `#222`
- 边框: 1px `#555`
- 圆角: 10px
- 内边距: 20px

**内容**:
- 显示所有凭证
- 每个凭证显示: 类型、颁发时间、有效期
- 操作按钮: 验证、删除

## 7. CSS 动画定义

### 7.1 通知动画

```css
@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}
```

### 7.2 凭证弹出动画

```css
@keyframes credentialPop {
    0% {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0;
    }
    50% {
        transform: translate(-50%, -50%) scale(1.1);
    }
    100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
    }
}
```

## 8. 颜色规范

### 8.1 主题色

- 背景色: `#1a1a1a` (深灰)
- 面板背景: `rgba(0, 0, 0, 0.8)` (半透明黑)
- 文字颜色: `#ffffff` (白)
- 边框颜色: `#555` (中灰)

### 8.2 状态色

- 成功/在线: `#4CAF50` (绿)
- 错误/离线: `#f44336` (红)
- 警告: `#ff9800` (橙)
- 信息/系统: `#2196F3` (蓝)
- 主题: `#00ff00` (亮绿)

### 8.3 特殊色

- 昵称: `#2196F3` (蓝)
- 凭证: `#9C27B0` (紫)
- 时间戳: `#888` (浅灰)

## 9. 字体规范

- 字体族: `'Courier New', monospace` (等宽字体)
- 标题: 标准字重
- 消息: 标准字重
- 昵称: 加粗
- 系统消息: 斜体
- 时间戳: 小字 (11px)

## 10. 响应式设计

当前设计主要为桌面端优化,暂不支持移动端响应式布局。

## 11. 交互规范

### 11.1 按钮交互

- 悬停状态: 背景色变亮 `#555`
- 禁用状态: 按钮不可点击
- 点击反馈: 无延迟响应

### 11.2 输入框交互

- 聚焦状态: 选中输入框
- Enter 键: 发送消息
- 输入验证: 空消息不发送

### 11.3 滚动交互

- 鼠标滚轮: 上下滚动
- 自动滚动: 新消息自动滚动到底部
- 保持位置: 用户手动滚动时保持当前位置

## 12. 技术实现

### 12.1 HTML 结构

- 使用语义化标签
- 面板使用 `div` 元素
- 样式使用内联 CSS 和 `<style>` 标签

### 12.2 JavaScript 逻辑

- UI 管理类: `GameUI`
- 事件监听: 使用 `addEventListener`
- 定时更新: `setInterval` (玩家列表)
- 实时更新: WebSocket 消息回调

### 12.3 数据流

```
用户操作 → GameUI → Network → WebSocket
                              ↓
                         Server → WebSocket
                              ↓
                    GameUI → 渲染更新
```

## 13. 性能优化

### 13.1 渲染优化

- Canvas 渲染频率: 60 FPS
- 玩家列表更新频率: 1 秒
- 消息数量限制: 最多 100 条

### 13.2 DOM 操作优化

- 使用文档片段减少重绘
- 事件委托减少监听器数量
- 及时清理过期元素

## 14. 可访问性

- 按钮提供清晰的文字标签
- 颜色对比度符合 WCAG 标准
- 键盘导航支持 (Enter 发送消息)

## 15. 国际化支持

当前仅支持中文界面,英文部分为技术术语。

## 16. 未来扩展

### 16.1 计划功能

- 移动端响应式布局
- 主题切换 (浅色/深色)
- 多语言支持
- 自定义快捷键
- 消息搜索功能

### 16.2 改进方向

- 更丰富的表情支持
- 语音聊天集成
- 屏幕共享功能
- 游戏内录像回放

---

**文档版本**: 1.0
**最后更新**: 2026-01-21
**维护者**: Aries Game System Team
